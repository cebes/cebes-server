syntax = "proto3";

package cebes;
option java_multiple_files = true;
option java_package = "io.cebes.pipeline.protos";
option java_outer_classname = "PipelineProtos";

import "stage.proto";
import "message.proto";

message PipelineDef {
    // The unique ID of this Pipeline.
    // Normally a UUID generated by the server
    string id = 1;

    // list of stages in this pipeline
    repeated StageDef stage = 2;
}

// request running a pipeline
// given the input in feeds,
// and requesting output at slots specified in outputs
message PipelineRunDef {

    // the pipeline to be run
    // can be a full pipeline definition
    // or just the ID of the pipeline, in which case it will be used to look up the pipeline on the server
    PipelineDef pipeline = 1;

    // the input map for some of the input slots
    // Each key is "stage:input_slot" with "stage" being a string name and
    // "input_slot" indicating which input slot to use from "stage".
    // If "input_slot" is default, then the ":default" suffix can be omitted.
    map<string, PipelineMessageDef> feeds = 2;

    // which output slot to be collected
    // in the "stage:output_slot" format
    repeated string outputs = 3;
}